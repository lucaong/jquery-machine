/*! jQuery Machine - v1.0.1 - 2014-05-27
 * https://github.com/lucaong/jquery-machine
 * Copyright (c) 2014 Luca Ongaro; Licensed MIT 
 */
if("function"!=typeof jQuery)throw"Expected jQuery to have been loaded before this script.";!function(a,b){"use strict";a.fn.machine=function(c,d){return d=a.extend({scope:!1,setClass:!1,defaultState:!1},d),this.each(function(){var e,f,g=/([^\s]+)\s*(.+)?/,h=a(this),i={},j="defaultState",k=d.scope?d.scope+"-":"",l=k+"state",m=k+"machine",n=function(a,b){return a&&"function"==typeof a[b]?a[b].apply(h,Array.prototype.slice.call(arguments,2)):void 0};a.each(c,function(b,c){c.defaultState&&(j=b),c.events=c.events||c.exits||{},i[b]={},a.each(c.events,function(c,d){a.each(c.split(/\s*,\s*/),function(a,c){var e=g.exec(c);e[1]&&(i[b][c]={evt:e[1],selector:e[2]||"",exit:d})})})}),d.defaultState&&(j="function"==typeof d.defaultState?d.defaultState.apply(h)||j:d.defaultState),h.data(m,c),h.data(l,j),d.setClass&&h.addClass(k+j),e=function(c){if(null===i[c]||b===i[c])throw"defaultState"===c?"None of the supplied states is the defaultState. Please check your code.":"The state '"+c+"' has not been correctly defined. Please check your code.";a.each(i[c],function(b,c){var g=c.evt.replace(/^\s+|\s+$/g,"")+".jquery-machine";h.on(g,c.selector,function(c){var g=h.data(m),j=h.data(l),o=i[j][b]?i[j][b].exit:!1,p=a.isFunction(o)?o.apply(h,arguments):o;p&&(n(g[j],"onExit",c,p),d.setClass&&h.removeClass(k+j),f(j),h.data(l,p),e(p),d.setClass&&h.addClass(k+p),n(g[p],"onEnter",c,j))})})},f=function(b){a.each(i[b],function(a,b){var c=b.evt.replace(/^\s+|\s+$/g,"")+".jquery-machine";h.off(c,b.selector)})},e(j),n(h.data(m)[j],"onEnter")})}}(jQuery);